name: Run Maintenance Tests

on:
  push:
    branches: [ 1.0.lb0 ]
  workflow_dispatch:  

jobs:
  execute-tests:
    name: Run test script
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Setup Miniconda
      uses: conda-incubator/setup-miniconda@v3
      with:
        miniconda-version: "latest"
        python-version: "3.8.6"
        activate-environment: "test-env"
        auto-activate-base: false
        channels: conda-forge,defaults
        channel-priority: strict

    - name: Copy Python files
      run: cp *.py maintenance/tests/

    - name: Make script executable
      run: chmod +x maintenance/tests/DO_TEST.sh

    - name: Run tests
      shell: bash -l {0}
      run: |
        maintenance/tests/DO_TEST.sh
